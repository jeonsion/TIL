# 머신러닝 개요

`머신 러닝은` 데이터가 주어지면, 기계가 스스로 `데이터로부터 규칙성을` 찾는 것에 집중한다.

주어진 데이터로부터 규칙성을 찾는 과정을 `훈련`, 또는 `학습` 이라고 한다. 

## 1. 머신러닝 모델의 평가

![데이터.png](%E1%84%86%E1%85%A5%E1%84%89%E1%85%B5%E1%86%AB%E1%84%85%E1%85%A5%E1%84%82%E1%85%B5%E1%86%BC%20%E1%84%80%E1%85%A2%E1%84%8B%E1%85%AD%20586338b9f50b48a9afb707ee0141be64/%25EB%258D%25B0%25EC%259D%25B4%25ED%2584%25B0.png)

머신 러닝을 위한 데이터를 준비했다면, 기계를 학습하기 전 해당 데이터를 `훈련용`, `검증용`, `테스트용` 세가지로 분리하는 것이 일반적이다. 

- 훈련용 데이터  : 모델을 학습하는 용도
- 테스트 데이터 : 모델의 성능을 평가하기 위한 용도
- 검증용 데이터 : 모델의 성능을 `조정하기` 위한 용도

`검증용` 데이터의 경우에는 정확히 모델이 훈련 데이터에 `overfitting` 되고 있는지 판단하거나 `하이퍼파라미터`를 조정하기 위한 용도이다.

> 하이퍼파라미터(초매개변수) : 모델의 성능에 영향을 주는 사람이 값을 지정하는 변수.
 ex) `선형회귀에서 경사하강법에서의 학습률`, 딥러닝에서 `뉴런의 수` 또는 `층의 수`  →뒤에서 알아보자
매개변수 : 가중치와 편향. 학습을 하는 동안 값이 계속해서 변하는 수.
> 

### 하이퍼 파라미터 튜닝이란?

`가중치나 편향과` 같은 매개변수는 **모델이 학습하는 과정**에서 얻어지는 값이다. (사용자가 결정해주는 값이 아님).

훈련용 데이터로 훈련을 모두 시킨 모델은 `검증용 데이터를 사용`하여 `정확도를` 검증하며 `하이퍼파라미터를 튜닝`한다. 

즉, 검증용 데이터에 대해서 높은 정확도를 얻도록 하이퍼파라미터 값을 바꿔보는 것.

> 튜닝하는 과정에서 모델은 검증용 데이터의 정확도를 높이는 방향으로 점차 수정됨
> 

### 모델의 최종 평가

모델을 평가하는 것은 한번도 보지 못한 데이터인 테스트 데이터의 몫

## 2. 분류(Classification)와 회귀(Regression)

머신 러닝의 많은 문제는 분류 또는 회귀 문제에 속한다.

<회귀>

- 선형 회귀
- 로지스틱 회귀(이름은 회귀이지만 대표적인 분류문제)

<분류>

- 이진분류
- 다중 클래스 분류
    
    

**1) 이진 분류문제**

두 개의 선택지 중 하나의 답을 선택해야하는 경우. ex) 스팸 메일 분류

**2) 다중 클래스 분류**

주어진 입력에 대해서 세 개 이상의 선택지 중에서 답을 선택해야하는 경우

**3) 회귀 문제**

위에 분류 예시 처럼 몇 개의 선택지 중에서 정해져 있는 경우가 아닌, `연속적인 값의 범위 내에서 예측값이 나오는 경우` 

ex 1) 역과의 거리, 인구 밀도, 방의 개수 등을 이용하여 부동산 가격 예측

ex 2) 시계열 데이터를 이용한 주가 예측, 생산량 예측, 지수 예측

## 3. 지도 학습과 비지도 학습

**1) 지도학습**

`레이블`이라는 `정답`과 함께 학습하는 것. 레이블이라는 말 외에도 y, 실제값 등으로 부르기도 함.

기계는 예측값과 실제값의 차이인 오차를 줄이는 방식으로 학습을 하게 된다.

- 대표적인 모델 : `분류` 모델, `예측`(`회귀`) 모델

**2) 비지도 학습**

데이터에 별도의 레이블이 없이 학습하는 것

여러 문제를 학습함으로써 해당 데이터의 `패턴`, `특성` 및 `구조를 스스로 파악`하여, 이를 통해 새로운 데이터에서 일정한 `규칙성을` 찾는 방법

- 대표적인 모델 : `군집화`(clustering)

**3) 자기지도 학습**

레이블이 없는 데이터가 주어지면, `모델이 학습을 위해서 스스로 데이터로부터 레이블을 만들어서 학습`하는 경우

## 4. 샘플(Sample)과 특성(Feature)

많은 머신러닝 문제는 1개이상의 `독립 변수 x`를 가지고 `종속 변수` y를 예측하는 문제이다.

머신러닝 모델 중 특히 `인공신경망은` 독립 변수, 종속 변수, 가중치, 편향 등을 행렬 연산을 통해 연산하는 경우가 많다. 이 때 훈련 데이터를 행렬로 표현하는 경우를 많이 볼  수 있는데, 독립변수 x의 행렬을 X라고 하였을 때, `독립 변수의 개수가 n`개이고 `데이터의 개수가 m`인 행렬 X는 다음과 같다.

![n_x_m.png](%E1%84%86%E1%85%A5%E1%84%89%E1%85%B5%E1%86%AB%E1%84%85%E1%85%A5%E1%84%82%E1%85%B5%E1%86%BC%20%E1%84%80%E1%85%A2%E1%84%8B%E1%85%AD%20586338b9f50b48a9afb707ee0141be64/n_x_m.png)

이 때 머신 러닝에서는 하나의 데이터, 행렬 관점에서는 하나의 `행`을 샘플(Sample)이라고 부른다.

그리고 종속 변수 y를 예측하기 위한 각각의 독립변수 x를 특성(Feature)이라고 부른다. 행렬 관점에선느 각 `열`에 해당

## 5. Confusion Matrix

![Untitled](%E1%84%86%E1%85%A5%E1%84%89%E1%85%B5%E1%86%AB%E1%84%85%E1%85%A5%E1%84%82%E1%85%B5%E1%86%BC%20%E1%84%80%E1%85%A2%E1%84%8B%E1%85%AD%20586338b9f50b48a9afb707ee0141be64/Untitled.png)

위와 표를 이용하여 머신러닝에서는 다음과 같은 네 가지의 케이스를 정의한다.

- **True Positive(TP)** : 실제 True인 정답을 True라고 예측 (정답)
- **False Positive(FP)** : 실제 False인 정답을 True라고 예측 (오답)
- **False Negative(FN)** : 실제 True인 정답을 False라고 예측 (오답)
- **True Negative(TN)** : 실제 False인 정답을 False라고 예측 (정답)

이 개념을 이용하여 정밀도, 재현율, 정확도 등을 알 수 있다.

**1) 정밀도(Precision)**

정밀도란 모델이 True라고 분류한 것 

중에서 실제 True인 것의 비율.

![Untitled](%E1%84%86%E1%85%A5%E1%84%89%E1%85%B5%E1%86%AB%E1%84%85%E1%85%A5%E1%84%82%E1%85%B5%E1%86%BC%20%E1%84%80%E1%85%A2%E1%84%8B%E1%85%AD%20586338b9f50b48a9afb707ee0141be64/Untitled%201.png)

**2) 재현율(Recall)**

재현율이란 실제 True인 것 중에서 모델이 True라고 예측한 것의 비율

![Untitled](%E1%84%86%E1%85%A5%E1%84%89%E1%85%B5%E1%86%AB%E1%84%85%E1%85%A5%E1%84%82%E1%85%B5%E1%86%BC%20%E1%84%80%E1%85%A2%E1%84%8B%E1%85%AD%20586338b9f50b48a9afb707ee0141be64/Untitled%202.png)

**3) 정확도(Accuracy)**

전체 예측한 데이터 중에서 정답을 맞춘 것에 대한 비율

![Untitled](%E1%84%86%E1%85%A5%E1%84%89%E1%85%B5%E1%86%AB%E1%84%85%E1%85%A5%E1%84%82%E1%85%B5%E1%86%BC%20%E1%84%80%E1%85%A2%E1%84%8B%E1%85%AD%20586338b9f50b48a9afb707ee0141be64/Untitled%203.png)

## 6. 과적합(Overfitting)과 과소 적합(Underfitting)

### 과적합

훈련 데이터를 과하게 학습한 경우 → 훈련데이터에 대해서만 과하게 학습을 하면 테스트 데이터나 실제 서비스에서 정확도가 좋지 않은 현상

![스팸_메일_오차.png](%E1%84%86%E1%85%A5%E1%84%89%E1%85%B5%E1%86%AB%E1%84%85%E1%85%A5%E1%84%82%E1%85%B5%E1%86%BC%20%E1%84%80%E1%85%A2%E1%84%8B%E1%85%AD%20586338b9f50b48a9afb707ee0141be64/%25EC%258A%25A4%25ED%258C%25B8_%25EB%25A9%2594%25EC%259D%25BC_%25EC%2598%25A4%25EC%25B0%25A8.png)

위 그래프는 과적합 상황에서 발생할 수 있는 훈련데이터에 대한 훈련 횟수에 따른 훈련데이터의 오차와 테스트 데이터의 오차(loss라고도 부름)의 변화를 보여준다. **RNN을 이요한 스팸 메일 분류 예시**

에포크가 3~4에서 테스트 데이터에 대한 정확도가 가장 높고, 에포크가 그 이상을 넘어가면 과적합이 발생한다.

### 과소적합

테스트 데이터의 성능이 올라갈 여지가 있음에도 불구하고 훈련을 덜 한 상태를 과소적합 이라고 한다.

과적합 방지를 고려한 일반적인 딥 러닝 모델의 학습 과정은 다음과 같다.

- Step 1. 주어진 데이터를 훈련 데이터, 검증 데이터, 테스트 데이터로 나눈다. 가령, 6:2:2 비율로 나눌 수 있다.
- Step 2. 훈련 데이터로 모델을 학습한다. (에포크 +1)
- Step 3. 검증 데이터로 모델을 평가하여 검증 데이터에 대한 정확도와 오차(loss)를 계산한다.
- Step 4. 검증 데이터의 오차가 증가하였다면 과적합 징후이므로 학습 종료 후 Step 5로 이동, 아니라면 Step 2.로 재이동한다.
- Step 5. 모델의 학습이 종료되었으니 테스트 데이터로 모델을 평가한다.
